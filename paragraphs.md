# パラグラフ

[ブロック]
← [目次] →
[見出し]

------------------------------------------------------------------------

パラグラフはHTML要素の[`<p>`](https://developer.mozilla.org/ja/docs/Web/HTML/Element/p)に対応し、[空行]ではない1行以上の連続テキスト行で表現する。

## ソフト改行

TODO: これは必要

## ハード改行

TODO: これは必要








## ベストプラクティス

* 連続する[インライン]構文の行で記述する
* 英語のように単語をスペースで区切る言語は([ソフト改行]を用い)複数行に分割可
* 日本語のように単語間に空白を入れない言語は改行せず一行にまとめて書く

```markdown
This is an example paragraph written in English.
[Soft line breaks](soft-line-breaks.md) work well
in English and other alphabet-based languages.

これは日本語で書かれたパラグラフの例。日本語に[ソフト改行](soft-line-breaks.md)を用いることも可能だが、改行部分に余計な半角スペースが入ってしまう。そのためこのように一行で記述する。
```

> This is an example paragraph written in English.
> [Soft line breaks](soft-line-breaks.md) work well
> in English and other alphabet-based languages.
> 
> これは日本語で書かれたパラグラフの例。日本語に[ソフト改行](soft-line-breaks.md)を用いることも可能だが、改行部分に余計な半角スペースが入ってしまう。そのためこのように一行で記述する。

その他の記述上のポイントは次の通り。詳しくはこの先の[文例](#文例)で説明する。

* 前後に[空行]を入れる(常に必要ではないが誤検出防止に効果的)
* 必要ではない状況で先頭にインデント空白を入れない(同上)
* 行末スペースに注意(2個以上あると[ハード改行]と認識される)
* 行頭パターンが他のブロック構文と重なる場合は[バックスラッシュエスケープ]が必要

## まとめ

* [空行]でないインライン構文行の1行以上連続として記述
* 先頭行はスペース3つまでインデント可能(除去して処理)
* 2行目以降は先頭の空白(いくらでも)を除去して処理
* 最終ではない行は行末で次のように判定
    * スペースなしまたは1個 → [ソフト改行]
        * HTMLレンダリング時にスペース区切りの1行に連結される
    * スペース2個以上または`\` →[ハード改行]
        * `<br>`を挿入して改行するが、同じパラグラフの継続として扱う
* 前後に別のブロック構文を検出するとそこで区切りと判定する
* 直前にコンテナブロック構文がある場合は注意

## 文例

### 行頭スペースの除去

先頭行にはインデントスペース3つまで使用可能(除去して処理)。4つ以上は[インデント式コードブロック]と認識される。

```markdown
パラグラフ1

 パラグラフ2

  パラグラフ3

   パラグラフ4

    コードブロック
```

> パラグラフ1
> 
>  パラグラフ2
> 
>   パラグラフ3
> 
>    パラグラフ4
> 
>     コードブロック

先頭行をパラグラフと認識すると、次行以降は先頭の空白を除去してから処理する。次の文例では2行目以降は行頭空白を除した後、前の行から[ソフト改行]した継続行としてHTMLレンダリング時に連結される。

```markdown
パラグラフ先頭行
     2行目
  3行目
          4行目
```

> パラグラフ先頭行
>      2行目
>   3行目
>           4行目

### 行連結と改行

複数行に渡るパラグラフは同じ`<p>`要素として扱われるが、各行の行末の状態により処理が異なる。

* 行末が`\`またはスペース2個以上 → [ハード改行]\(`<br>`を挿入)
* それ以外 → [ソフト改行]\(スペース1つを挿入して次行と連結)

```markdown
行末はハード改行\
行末はソフト改行
継続行(スペース1つの後に前の行と連結)
```

> 行末はハード改行\
> 行末はソフト改行
> 継続行(スペース1つの後に前の行と連結)

### 直前構文との認識

直前が[横線]、[見出し]の場合は[空行]不要。

```markdown
------------------------------------------------------------------------
パラグラフ

### 見出し
パラグラフ
```

> ------------------------------------------------------------------------
> パラグラフ
> 
> ### 見出し
> パラグラフ

[表]には[空行]が必要。

```markdown
| 表 |
| - |
| セル |
これもセル

| 表 |
| - |
| セル |

パラグラフ
```

> | 表 |
> | - |
> | セル |
> これもセル
> 
> | 表 |
> | - |
> | セル |
> 
> パラグラフ


直前が[コンテナブロック]の場合も[空行]が必要。

```markdown
> 引用
引用の継続(パラグラフではない)

> 引用

パラグラフ

- リスト
リストの継続(パラグラフではない)

- リスト

パラグラフ
```

> > 引用
> 引用の継続(パラグラフではない)
> 
> > 引用
> 
> パラグラフ
> 
> - リスト
> リストの継続(パラグラフではない)
> 
> - リスト
> 
> パラグラフ

さらにリストの場合は[空行]の後にインデント付きパラグラフを記述するとリストアイテムのインデントと認識され、その内部のパラグラフとして扱われる。

```
- リストアイテム

  上記リストアイテム内のパラグラフ
```

> - リストアイテム
> 
>   上記リストアイテム内のパラグラフ

以上の扱いにはやや複雑な点があるので、通常のパラグラフとして記述する場合は次の2点を覚えておくとよい。

* [空行]は常に入れる
* パラグラフに行頭インデントを用いない

### 直後構文との認識

次行が[空行]の場合はパラグラフ終了で、以降を次のブロック構文と認識する。

```markdown
このパラグラフ行は継続(ソフト改行して次行と連結)
このパラグラフ行で終了(直後が空行)

次のパラグラフ
```

> このパラグラフ行は継続(ソフト改行して次行と連結)
> このパラグラフ行で終了(直後が空行)
> 
> 次のパラグラフ

直後に他のブロック構文がある場合も同様で、[GFM]/[CommonMark]仕様では次のケースでは間に[空行]は不要。

``````markdown
このパラグラフ行で終了(直後がブロック構文)
```
コードブロック
```

このパラグラフ行で終了(直後がブロック構文)
> 引用

このパラグラフ行で終了(直後がブロック構文)
- リスト
``````

> このパラグラフ行で終了(直後がブロック構文)
> ```
> コードブロック
> ```
> 
> このパラグラフ行で終了(直後がブロック構文)
> > 引用
> 
> このパラグラフ行で終了(直後がブロック構文)
> - リスト

ただし[空行]を入れた方が作業時に認識しやすいという利点はある。さらに他のMarkdown実装には[空行]が必要なものが多く、可搬性を考慮した場合に有利になる(推奨)。

<details>
<summary>他のMarkdown実装との仕様比較</summary>

次の文例を考える(間に[空行]なし)。

```markdown
Paragraph
- List
```

Babelmarkの確認結果は次の通り。`- List`を[リスト]ではなくパラグラフの続きと認識する実装が多数ある。

https://babelmark.github.io/?text=Paragraph%0A-+List

次に改行を入れる。

```markdown
Paragraph

- List
```

結果は次の通り。今後は全実装が[リスト]と認識する。

https://babelmark.github.io/?text=Paragraph%0A%0A-+List

このように[空行]の挿入は可搬性の観点で大きな効果がある。[空行]不要なMarkdownでは単に無視するだけで無害なので、間に[空行]を入れることを(強く)推奨する。

</details>

### バックスラッシュエスケープ

パラグラフを構成する行の先頭に他のブロック構文と認識される文字列パターンがある場合は[バックスラッシュエスケープ]で認識させる。

```markdown
\----------
前の行は横線ではない
\### 見出しではない
\- リストアイテムではない
```

> \----------
> 前の行は横線ではない
> \### 見出しではない
> \- リストアイテムではない

## 日本語の扱い

Markdownのパラグラフはもともと英語など単語をスペースで区切る言語を想定しており、任意の単語区切りスペースで改行できるようにできている(HTMLも同様)。しかしこれは単語をスペースで区切らない言語(特に日本語)との相性が悪い。

例えば日本語の文章を40文字(全角20文字)で[ソフト改行]した次のパラグラフを考える。

```markdown
いづれの御時にか、女御、更衣あまたさぶら
ひたまひけるなかに、いとやむごとなき際に
はあらぬが、すぐれて時めきたまふありけり
。
```

しかしこれでは改行部分のHTML出力に通常の日本語文では用いられない半角スペースが入ってしまう。

> いづれの御時にか、女御、更衣あまたさぶら
> ひたまひけるなかに、いとやむごとなき際に
> はあらぬが、すぐれて時めきたまふありけり
> 。

日本語らしく間を開けずに表示するには編集時に全部一行につなげて記述するよりない。

```markdown
いづれの御時にか、女御、更衣あまたさぶらひたまひけるなかに、いとやむごとなき際にはあらぬが、すぐれて時めきたまふありけり。
```

> いづれの御時にか、女御、更衣あまたさぶらひたまひけるなかに、いとやむごとなき際にはあらぬが、すぐれて時めきたまふありけり。

------------------------------------------------------------------------

[ブロック]
← [目次] →
[見出し]

[ブロック]: blocks.md
[見出し]: headings.md
[目次]: index.md

[ASCII区切り文字]: backslash-escapes.md#ASCII区切り文字
[CommonMark]: introduction.md#commonmark
[GFM]: introduction.md#11-github-flavored-markdownとは
[インデント式コードブロック]: indented-code-blocks.md
[インライン]: inlines.md
[コンテナブロック]: container-blocks.md
[ソフト改行]: soft-line-breaks.md
[ハード改行]: hard-line-breaks.md
[バックスラッシュエスケープ]: backslash-escapes.md
[リスト]: lists.md
[空行]: blank-lines.md
[表]: tables.md
[横線]: thematic-breaks.md
