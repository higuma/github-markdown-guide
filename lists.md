# リスト

[ブロック引用]
← [目次] →
[タスクリスト]

------------------------------------------------------------------------

MarkdownのリストはHTMLの[順序なしリスト](https://developer.mozilla.org/ja/docs/Web/HTML/Element/ul)または[順序付きリスト](https://developer.mozilla.org/ja/docs/Web/HTML/Element/ol)を表現する。内部に他のアイテムを再帰的に記述可能で、リスト項目がその内部に別のリストを含んでいてもよい。

## 基本的な書き方

リスト全体は同種のリスト項目行の連続で表現する。

```markdown
- 順序なしリスト項目1
- 順序なしリスト項目2
- 順序なしリスト項目3

1. 順序付きリスト項目1
2. 順序付きリスト項目2
3. 順序付きリスト項目3

パラグラフ
```

> - 順序なしリスト項目1
> - 順序なしリスト項目2
> - 順序なしリスト項目3
> 
> 1. 順序付きリスト項目1
> 2. 順序付きリスト項目2
> 3. 順序付きリスト項目3
> 
> パラグラフ

## リスト項目

リスト項目は **行頭マーカー** **スペース区切り** **コンテンツ** の順で記述する。行頭マーカーは順序なしの場合と順序ありの場合で異なる書式を用いる。スペース区切りとコンテンツに関しては両者で共通の書式を用いる。

そして同じ種類の行頭マーカーを持つリスト項目の連続をリストと認識する。以下順序なしの場合、順序ありの場合の書式を解説する。

## 順序なしリスト

順序なしリスト項目に用いる行頭マーカーは`-`, `+`, `*`の3種類で、スペース区切りの後にコンテンツを記述する。そしてこれらの連続を全体でひとつの順序なしリストと認識する。

```markdown
- foo
- bar

+ abc
+ xyz

* あいうえお
* かきくけこ
```

> - foo
> - bar
> 
> + abc
> + xyz
> 
> * あいうえお
> * かきくけこ

順序なしリストが2つ連続する場合はマーカー変更が必要。次は失敗例で、[空行]を入れても同じリストの継続と認識する。

```markdown
- ABC
- XYZ

- あいうえお
- かきくけこ
```

> - ABC
> - XYZ
> 
> - あいうえお
> - かきくけこ

マーカーを変更すると別のリストと認識する。2行目と3行目の行間隔が広がることに注意。

```markdown
- ABC
- XYZ

* あいうえお
* かきくけこ
```

> - ABC
> - XYZ
> 
> * あいうえお
> * かきくけこ

できるだけ多くのMarkdown実装で動作するように記述するためのポイントを示す。

- 行頭マーカーとして`-`または`*`を用いる(`+`を認識しない実装がある)
- コンテンツとの間にスペースをひとつ入れる
- 同じリストの中では常に同種のマーカーを用いる
- リスト全体の前後に[空行]を入れる
- 2つの連続する異なるリストではマーカーを変えて区別する
  - 同種マーカーだと間に[空行]を入れても文法的に分離されないので注意
  - ただしこの方法も効かない実装が多い(Markdownの文法は緩く不完全なのでこういうことはよくある)

<details>
<summary>Markdown実装による仕様の違い</summary>

リスト項目は複数行に渡る場合があるため、リストが2つ連続する場合は[空行]だけではブロック区切りと認識しない。次の文例を用いてBabelMarkで確認すると、全ての実装が単一のリストと認識するのが分かる。

```markdown
- A
- B

- X
- Y
```

https://babelmark.github.io/?text=-+A%0A-+B%0A%0A-+X%0A-+Y

そのため上下を別のリストと認識させるにはマーカーを変える必要がある。ただしこの方法も認識しない実装が多数あることに注意。BabelMark確認結果は次の通り。

```markdown
- A
- B

* X
* Y
```

https://babelmark.github.io/?text=-+A%0A-+B%0A%0A*+X%0A*+Y

また`+`を順序付きリストと認識するMarkdown実装が1つだけ存在する([Gambas])。次のBabelMark確認結果の最後の部分を見ると分かる。

```markdown
- A

* B

+ C
```

<https://babelmark.github.io/?text=-+A%0A%0A*+B%0A%0A%2B+C>

</details>

## 順序付きリスト

順序付きリストの行頭マーカーは`1.`と`1)`の2種類あり(0以上の10進整数の後に`.`または`)`)、こちらも順序なしリストと同じようにスペース区切りの後にコンテンツを記述する。そしてこれらの連続を全体でひとつの順序付きリストと認識する。

```markdown
1. あいうえお
2. かきくけこ

1) abc
2) xyz
```

> 1. あいうえお
> 2. かきくけこ
> 
> 1) abcdefg
> 2) xyz

先頭アイテムは順序数を設定できる。また2番目以降は0以上の整数なら何でも同じで、常に直前アイテムに1を加えた値で表示する。

```markdown
100. foo
999999. bar
```

> 100. foo
> 999999. bar

順序付きリストの場合も2つ連続する場合はマーカーを変える必要がある。次のように[空行]を入れても効果はなく同じリストの続きと認識される。

```markdown
1. ABC
2. DEF

1. PQR
2. STU
```

> 1. ABC
> 2. DEF
> 
> 1. PQR
> 2. STU

マーカーを変えれば別のリストとして扱われる。

```markdown
1. ABC
2. DEF

1) PQR
2) STU
```

> 1. ABC
> 2. DEF
> 
> 1) PQR
> 2) STU

<details>
<summary>Markdown実装による動作の違い</summary>

順序付きリストの場合は`1)`の形式を認識しないものが多い。BabelMarkで確認するとCommonMarkの流れを汲んでいる実装しか認識していないことが分かる。

```markdown
1. A
2. B

1) X
2) Y
```

https://babelmark.github.io/?text=1.+A%0A2.+B%0A%0A1)+X%0A2)+Y

先頭数の設定はCommonMark系ではほぼ全てサポートしているが、それ以外は機能しないものが多い。

```markdown
100. A
1000. B
```

https://babelmark.github.io/?text=100.+A%0A1000.+B

</details>

<details>
<summary><strong>スペース区切り</strong></summary>

### スペース区切り

> **文書作成法の習得が目的の読者は読む必要なし。常にスペース1個を入れると覚えておけばよい。**
> 
> 以下の文例ではマーカーの種類を交互に変えていることに注意。2つの連続するリストの場合、[空行]だけではブロック区切りと認識されないためこの方法を用いている。

マーカーとコンテンツの間にはスペースが1個以上必要(ないとリストと認識しない)。4個以内はコンテンツ先頭インデントとして除去し、5個以上は[インデントによるコードブロック]と認識する。

順序なしの場合。

```markdown
-NO SPACE

* SPACE x 1

-  SPACE x 2

*   SPACE x 3

-    SPACE x 4

*     SPACE x 5

-      SPACE x 6
```

> -NO SPACE
> 
> - SPACE x 1
> 
> -  SPACE x 2
> 
> -   SPACE x 3
> 
> -    SPACE x 4
> 
> -     SPACE x 5
> 
> -      SPACE x 6

順序付きの場合。

```markdown
1.NO SPACE

1) SPACE x 1

1.  SPACE x 2

1)   SPACE x 3

1.    SPACE x 4

1)     SPACE x 5

1.      SPACE x 6
```

> 
> 1.NO SPACE
> 
> 1) SPACE x 1
> 
> 1.  SPACE x 2
> 
> 1)   SPACE x 3
> 
> 1.    SPACE x 4
> 
> 1)     SPACE x 5
> 
> 1.      SPACE x 6

<details>
<summary>Markdown実装による動作の違い</summary>

上記コード例のBabelMarkによる互換性チェック結果は次の通り。スペース5個以上を[インデントによるコードブロック]と認識しない実装が多数ある。

- [順序なしの場合](https://babelmark.github.io/?text=-NO+SPACE%0A%0A-+SPACE+x+1%0A%0A-++SPACE+x+2%0A%0A-+++SPACE+x+3%0A%0A-++++SPACE+x+4%0A%0A-+++++SPACE+x+5%0A%0A-++++++SPACE+x+6)
- [順序付きの場合](https://babelmark.github.io/?text=1.NO+SPACE%0A%0A1.+SPACE+x+1%0A%0A1.++SPACE+x+2%0A%0A1.+++SPACE+x+3%0A%0A1.++++SPACE+x+4%0A%0A1.+++++SPACE+x+5%0A%0A1.++++++SPACE+x+6)

</details>

</details>

<details>
<summary><strong>行頭インデント(非推奨)</strong></summary>

### 行頭インデント

> **非推奨**: これを使うと次で説明する[複数行に渡るリスト項目]との区別が難しくなり、実装によって出力が異なる状況が頻繁に発生する。

GitHub仕様では先頭に3文字までインデント用スペースを挿入可能で、4文字以上の場合は[インデントによるコードブロック]と認識する。

順序なしの場合。

```markdown
- NO INDENT SPACE

 * SPACE x 1

  - SPACE x 2

   * SPACE x 3

    - SPACE x 4

     * SPACE x 5
```

> - NO INDENT SPACE
> 
>  * SPACE x 1
> 
>   - SPACE x 2
> 
>    * SPACE x 3
> 
>     - SPACE x 4
> 
>      * SPACE x 5

順序付きの場合。

```markdown
1. NO INDENT SPACE

 1) SPACE x 1

  1. SPACE x 2

   1) SPACE x 3

    1. SPACE x 4

     1) SPACE x 5
```

> 1. NO INDENT SPACE
> 
>  1) SPACE x 1
> 
>   1. SPACE x 2
> 
>    1) SPACE x 3
> 
>     1. SPACE x 4
> 
>      1) SPACE x 5

<details>
<summary>Markdown実装による動作の違い</summary>

上記コード例のBabelMark出力は次の通り。動作は実装によって大きく異なり、少しでも文書の可搬性を考慮するのであれば使うべきでないことがよく分かる。

- [順序なしの場合](https://babelmark.github.io/?text=-+NO+INDENT+SPACE%0A%0A+*+SPACE+x+1%0A%0A++-+SPACE+x+2%0A%0A+++*+SPACE+x+3%0A%0A++++-+SPACE+x+4%0A%0A+++++*+SPACE+x+5)
- [順序付きの場合](https://babelmark.github.io/?text=1.+NO+INDENT+SPACE%0A%0A--------%0A%0A+1.+SPACE+x+1%0A%0A--------%0A%0A++1.+SPACE+x+2%0A%0A--------%0A%0A+++1.+SPACE+x+3%0A%0A--------%0A%0A++++1.+SPACE+x+4%0A%0A--------%0A%0A+++++1.+SPACE+x+5)

</details>

</details>

## 複数行に渡るリスト項目

[リスト項目]はそれ自身がブロックアイテムであり、内部に別の(インライン・ブロック両方の)アイテムを含むことができる。複数行に渡るリスト項目はインデントを用いて表現する。

インデントは行頭マーカーとスペースの後の最初の非空白文字(コンテンツ先頭)に合わせる(この記法が現在の主流)。次の文例では各リスト項目の先頭行コンテンツ先頭と同じ位置から2行目を記述している。これにより[行の連結]が行われ、スペースを挟んで一行で表示される。

```markdown
- アイテム1
  続き
- アイテム2
  続き

1. アイテム1
   続き
2. アイテム2
   続き
```

> - アイテム1
>   続き
> - アイテム2
>   続き
> 
> 1. アイテム1
>    続き
> 2. アイテム2
>    続き

> [Qiita]のMarkdownはこれとは異なる仕様で、スペースではなく改行を挿入し、テキストで見た通りに出力する。

インデントはネストの表現にも用いられる。多重リストは次のようにインデントレベルで表現する。

```markdown
1. 外側のリスト(レベル0)
   - 内部リスト(レベル1)
     1. さらに内部(レベル2)
   1. 別の内部リスト(レベル1)
      - その内側(レベル2)
1. 外側(レベル0)
```

> 1. 外側のリスト(レベル0)
>    - 内部リスト(レベル1)
>      1. さらに内部(レベル2)
>    1. 別の内部リスト(レベル1)
>       - その内側(レベル2)
> 1. 外側(レベル0)

[空行]を入れてその後にさらに続けることも可能で、次の例は[リスト項目]の内部に[パラグラフ]が2つあるものと認識される。

```markdown
- パラグラフ1
  続き

  パラグラフ2
  続き
```

> - パラグラフ1
>   続き
> 
>   パラグラフ2
>   続き

この他にも任意のアイテムを再帰的に含むことができる。最後にやや技巧的なコードを示す。

``````markdown
1. ```c
   // Code block
   #include <stdio.h>
   ```
2. > block-quated paragraph
   > (continue)
   > 
   > - [ ] inner task list
   > - [x] inner task list
``````

> 1. ```c
>    // Code block
>    #include <stdio.h>
>    ```
> 2. > block-quated paragraph
>    > (continue)
>    > 
>    > - [ ] inner task list
>    > - [x] inner task list

<details>
<summary>実装間の互換性</summary>

ただし上記のこのような書き方はMarkdown実装に大きく依存することに注意。上記文例はGitHubサイトでは意図した通りの結果になるのを確認済みだが、[BabelMark比較結果](https://babelmark.github.io/?text=1.+%60%60%60c%0A+++%2F%2F+Code+block%0A+++%23include+%3Cstdio.h%3E%0A+++%60%60%60%0A2.+%3E+block-quated+paragraph%0A+++%3E+(continue)%0A+++%3E+%0A+++%3E+-+%5B+%5D+inner+task+list%0A+++%3E+-+%5Bx%5D+inner+task+list)を見るとまともに変換しているものは皆無と言ってよい。必ず実環境で確認すること。

</details>

## リスト項目の認識

> 以下最後まで文書作成者ではなく実装者向けの詳細仕様の解説が続く。文書作成技術の習得が目的の読者は読む必要なし。標準的な記法から外れるほど実装に対する依存性が高くなり、意図しない動作を発生しやすい(上記の標準的記法以外は**全て非推奨**)。実装に興味がある読者向け。

現在は[リスト項目]先頭行のコンテンツ開始位置に合わせてインデントする記法が主流(標準的)だが、Markdownの文法は意図的に緩くできている。以下GitHub実装の仕様を説明するが、これらの多くは別実装では動作が異なる場合が多い点に注意すること。

### 行の連結

リスト項目先頭行の次がインデントなしの[インライン]アイテムの場合は継続行と認識して[行の連結]を行う。継続行の次も[インライン]だとそれも継続行となり、[空行]または別の[ブロック]アイテムに到達するとリスト項目の終了と認識する。

```markdown
1. リスト項目
**続き**
さらに続き
2. 次のリスト項目
**続き**
さらに続き
```

> 1. リスト項目
> **続き**
> さらに続き
> 2. 次のリスト項目
> **続き**
> さらに続き

ただし通常はインデントを用いて記述する(その方が明らかに見やすい)。[行の連結]の場合は([空行]を入れず)次の行に[インライン]の続きを記述する。継続行の手前のインデント用スペースはどんなに多くても単に除去して処理される。

```markdown
- 項目
               続き
```

> - 項目
>                続き

> GitHub以外のMarkdown環境ではこれとは異なる仕様が多い。例えば[Qiita]では行連結の際にスペースではなく改行を挿入する。

### インデント

[リスト項目]の中に[ブロック]アイテムを挿入する場合にインデントを用いる。ルールは次の通り。

- リスト項目先頭行のコンテンツ開始位置を基準として判定
  - 基準未満: 次の外部ブロックアイテム(リスト項目の終了)と判定
  - 基準から+3文字以内: リスト項目に含まれるアイテムと判定
  - +4文字以上:
    - 通常は継続行と判定([ブロック]アイテムではなくテキストとして扱う)
    - ただし手前に[空行]がある場合は[インデントによるコードブロック]と判定

> 念のため注意: 上級者用解説なので仕方なく説明しているが、こんな仕様を知っていても有用性はない。自分に必要ないと思ったら読まずに次へ進んでよい。

次の文例は内部アイテムとして[順序なしリスト]を用いた場合で、インデント個数により動作がどのように変化するかを示したもの。

```markdown
1. 項目
  - 外部アイテム(-1)
1. 項目
   - ここから内部(0)
1. 項目
    - 内部(+1)
1. 項目
     - 内部(+2)
1. 項目
      - ここまで内部(+3)
1. 項目
       - 継続行(+4)
```

> 1. 項目
>   - 外部アイテム(-1)
> 1. 項目
>    - ここから内部(0)
> 1. 項目
>     - 内部(+1)
> 1. 項目
>      - 内部(+2)
> 1. 項目
>       - ここまで内部(+3)
> 1. 項目
>        - 継続行(+4)

[見出し]の場合も同様。

```markdown
1. 項目
  ### 外部アイテム(-1)
1. 項目
   ### ここから内部(0)
1. 項目
    ### 内部(+1)
1. 項目
     ### 内部(+2)
1. 項目
      ### ここまで内部(+3)
1. 項目
       ### 継続行(+4)
```

> 1. 項目
>   ### 外部アイテム(-1)
> 1. 項目
>    ### ここから内部アイテム(0)
> 1. 項目
>     ### 内部(+1)
> 1. 項目
>      ### 内部(+2)
> 1. 項目
>       ### ここまで内部(+3)
> 1. 項目
>        ### 継続行(+4)

### 空行の挿入

内部アイテム用インデントと認識される行には途中に[空行]を挿入できる。この場合に挿入された空行は内部ブロックの区切りと認識し、これを用いて複数のパラグラフを記述できる。ただし[空行]の後に+4文字以上のインデントがあると継続行ではなく内部アイテムの[インデントによるコードブロック]として扱う。

```markdown
- パラグラフ1

   パラグラフ2

    パラグラフ3

     パラグラフ4

      コードブロック
```

> - パラグラフ1
> 
>    パラグラフ2
> 
>     パラグラフ3
> 
>      パラグラフ4
> 
>       コードブロック

この他にも実装者用の細かい仕様は色々あるが略。これくらいにしておく。

> これ以上はもうMarkdown実装者以外には不要な知識の部類に属し、文章を書く際には役に立たない。また仕様書に書き切れない詳細仕様は実装者本人に委ねられている部分があり、そのような部分を説明しても有用な情報ではないし、そもそも実装により動作が異なる。

------------------------------------------------------------------------

[ブロック引用]
← [目次] →
[タスクリスト]

[Gambas]: https://gambas.sourceforge.net/en/main.html
[HTMLブロック]: html-blocks.md
[Qiita]: https://qiita.com/
[インデントによるコードブロック]: code-blocks.md#インデントによるコードブロック
[インライン]: inlines.md
[タスクリスト]: task-lists.md
[パラグラフ]: paragraphs.md
[ブロック]: blocks.md
[ブロック引用]: block-quotes.md
[リスト項目]: #リスト項目
[行の連結]: paragraphs.md#行の連結
[空行]: characters.md#空行
[順序なしリスト]: #順序なしリスト
[順序付きリスト]: #順序付きリスト
[複数行に渡るリスト項目]: #複数行に渡るリスト項目
[見出し]: headings.md
[目次]: index.md

