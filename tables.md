# 表

[横線]
← [目次] →
[コードブロック]

------------------------------------------------------------------------

## 基本的な書き方

- 1行目は見出し行(太字表示)
- 2行目は区切り行
- 3行目以降はデータ行(通常表示)
- セルは左右を`|`で区切る
    - セル区切りとセル内容の間にスペース1つ以上(必須ではないが推奨)
- 区切り行のセル内は`-`を1個以上連続
    - アラインメント設定可能(後述)
- ヘッダセル、データセルの中に[インライン]を記述する
- 表の前後は[空行]で区切る

```markdown
|  見出し1  |  見出し2  |
| --------- | --------- |
| データ1-1 | データ1-2 |
| データ2-1 | データ2-2 |
```

> |  見出し1  |  見出し2  |
> | --------- | --------- |
> | データ1-1 | データ1-2 |
> | データ2-1 | データ2-2 |

### テキスト文書の整形

区切り行セルの`-`は1個以上いくらあってもよい。またヘッダセル及びデータセルの前後の空白は除去し、区切り行セルのアラインメント指定に従って処理する。そのためテキスト表示の整形は全く影響しない。次の2つは同一出力になる。

```markdown
|  one  |  two  |
| ----- | ----- |
| three | four  |

| one | two |
| - | - |
| three | four |
```

> |  one  |  two  |
> | ----- | ----- |
> | three | four  |
> 
> | one | two |
> | - | - |
> | three | four |

揃えた方が編集作業中の見栄えがよく認識性も優れている(作業時のエラー防止に役立つ)。しかし出力に違いはないので、作業の手間も考え状況に応じて判断すればよい。

### アラインメント

列ごとのアラインメント(左右寄せ)を区切り行セルで設定できる(`-`は1個以上連続)。

- `-` - 標準(見出しは中央寄せ、データは左寄せ)
- `:-` - 左寄せ
- `:-:` - 中央寄せ
- `-:` - 右寄せ

```markdown
|    標準    |   右寄せ   |  中央寄せ  |   左寄せ   |
| ---------- | :--------- | :--------: | ---------: |
| あいうえお | かきくけこ | さしすせそ | たちつてと |
|     1      |     2      |     3      |     4      |
```

> |    標準    |   右寄せ   |  中央寄せ  |   左寄せ   |
> | ---------- | :--------- | :--------: | ---------: |
> | あいうえお | かきくけこ | さしすせそ | たちつてと |
> |     1      |     2      |     3      |     4      |

### セルの記述

ヘッダとデータの各セルの中には任意の[インライン]アイテムを記述できる。

- ヘッダ行とデータ行のセル内に任意の[インライン]のシーケンスを記述可能
    - [ブロック]は挿入できない([リスト]、[コードブロック]などは不可)
- 空セルも可
- セル内に`|`を含む場合は[バックスラッシュエスケープ]して`\|`([コードスパン]内でも必要)

```markdown
| A | B | C |
| - | - | - |
| _abc_ | | **abc** |
| | ***abc*** | ~~abc~~ |
| [link](#) | https://example.com/ | &#x26BD; &#x26BE; |
| \|<var>x</var>\| + <var>y</var><sup>2</sup> | | `(0..9).each {\|n\| p n}` |
```

> | A | B | C |
> | - | - | - |
> | _abc_ | | **abc** |
> | | ***abc*** | ~~abc~~ |
> | [link](#) | https://example.com/ | &#x26BD; &#x26BE; |
> | \|<var>x</var>\| + <var>y</var><sup>2</sup> | | `(0..9).each {\|n\| p n}` |

特に内部に`|`を含む[コードスパン]がある場合に注意。通常は[コードスパン]内では[バックスラッシュエスケープ]が無効になるが、表セル内にあるコードスパン内の`|`は例外としてバックスラッシュエスケープして`\|`と書く必要がある(例: `(0..9).each {\|n\| p n}`)。

セルは一行の中に書く必要があるため[ハード改行]は使えないが、代わりに[HTMLインライン]の`<br>`を用いて改行を挿入できる。

```markdown
| 標準 | 左寄せ | 中央寄せ | 右寄せ |
| - | :- | :-: | -: |
| あいうえお<br>ABC | あいうえお<br>ABC | あいうえお<br>ABC | あいうえお<br>ABC |
```

> | 標準 | 左寄せ | 中央寄せ | 右寄せ |
> | - | :- | :-: | -: |
> | あいうえお<br>ABC | あいうえお<br>ABC | あいうえお<br>ABC | あいうえお<br>ABC |


## 詳細仕様

**注意**: 以下の内容は[GitHub Markdown環境]で確認した内容で、他のMarkdown環境では動作が異なる事が多い点に留意すること。

### データ行の省略

データ行なしも可能。この場合はヘッダ部だけ生成する。

```markdown
| ヘッダ1 | ヘッダ2 |
| - | - |
```

> | ヘッダ1 | ヘッダ2 |
> | - | - |

### 行ごとのセル個数

ヘッダ行と区切り行のセル数が等しくないと表として認識しない。

```markdown
| これは | 表 |
| - | - |
| A | B |

| これは | 表ではない |
| - |
| A | B |

| これも | 表ではない |
| - | - | - |
| A | B |
```

> | これは | 表 |
> | - | - |
> | A | B |
> 
> | これは | 表ではない |
> | - |
> | A | B |
> 
> | これも | 表ではない |
> | - | - | - |
> | A | B |

データ行のセル数は一致していなくてもよい。足りない場合は後ろに空セルを追加、多い場合は除去して生成する。

```markdown
| A | B |
| - | - |
| C |
| X | Y | Z |
```

> | A | B |
> | - | - |
> | C |
> | X | Y | Z |


## 記法(スタイル)の考察

ここから先は記法に関する考察が中心。細かい仕様確認と実装が中心で、ドキュメント作成記述の習得に専念したい人は読まなくてもよい。


### 行頭・行末の`|`

> 「行頭と行末の`|`は省略可能だが常に記述すべき」という趣旨。省略は可能だが、省略すると他の文法に誤認識されるケースがいくつも発生してしまう。以下はその退屈な説明だが、単に「常に記述する」と覚えておけば誤認識はまず発生せず、以下の内容を覚える必要もない。

行頭と行末の`|`はなくても認識する。

```markdown
A | B
-- | --
A1 | B1
```

> A | B
> -- | --
> A1 | B1

> この場合は区切り行の先頭セルは`-`が2個以上必要。`- | -`ではGitHub実装は行頭の`- `を検出して[リスト項目]と判定する。ただし他のMarkdown処理実装には表と認識するものも多い(→ [Babelmark]を用いた[比較検証結果](https://babelmark.github.io/?text=A+%7C+B%0A-+%7C+-%0AA1+%7C+B1))。

ただし先頭が空セルの場合は認識されない。次は失敗例で、データ行先頭のスペース3つは行頭インデントと判定され、単に除去されてセルとして認識されない。

```markdown
A  | B
-- | --
   | B1
```

> A  | B
> -- | --
>    | B1

さらにスペース4つ以上は[インデントによるコードブロック]と認識されてしまう。

```markdown
 A  |  B
--- | ---
    | B1
```

>  A  |  B
> --- | ---
>     | B1

またヘッダ行の最後が空セルの場合も行末に`|`が必要。次は表として認識されない。

```markdown
| A | B |
| - | - | -
| 1 | 2 | 3
```

> | A | B |
> | - | - | -
> | 1 | 2 | 3

行末に`|`を追加すれば認識する。

```markdown
| A | B | |
| - | - | -
| 1 | 2 | 3
```

> | A | B | |
> | - | - | -
> | 1 | 2 | 3

これら全てのケースの振る舞いを全て把握するのは大変かつ退屈で、さらに覚えたところで全く役に立たない。そうではなく「行頭と行末には(たとえ不要でもマナーとして)`|`を入れる」とだけ覚えておけばこのような間違いを未然に防ぐことができる(推奨)。

> この後も本章の最後まで同じような内容が続く。行頭・行末の`|`を省略せず、前後に空白を入れ、表の前後に空行を必ず入れておくことさえ覚えておけば読む必要なし。

### セル前後の空白

セル区切りの`|`とセルの中身の間の空白は処理時に除去される。記述としては空白は不要だが、作業時の認識性を考慮すると空白を入れた方がエラー防止効果がある。例えば次の文例は正しいが非常に判別しにくく、入力エラーの原因になりやすい。

```markdown
a|b
-|-
\|<var>p</var>\||\|<var>q</var>\|
```

> a|b
> -|-
> \|<var>p</var>\||\|<var>q</var>\|

スペースを入れるだけで認識性は格段に向上する。行頭と行末の`|`も入れるとなおよい。

```markdown
| a | b |
| - | - |
| \|<var>p</var>\| | \|<var>q</var>\| |
```

> | a | b |
> | - | - |
> | \|<var>p</var>\| | \|<var>q</var>\| |

### 表の認識(前後構文との関係)

表の手前には[空行]を入れておけば大部分のケースで正しく認識する。しかし[リスト]の直後に表を記述する場合は注意。次は(意図的に作成した)失敗例で、ヘッダ行ではなく[リスト項目]の内部記述と認識される。

```markdown
- リスト項目
  A   |   B
----- | -----
12345 | 67890
```

> - リスト項目
>   A   |   B
> ----- | -----
> 12345 | 67890

[空行]を入れても解決しない。(表を整形したのが仇となり)ヘッダ行がインデントを用いた[リスト項目]内部と認識され、区切り行以降が次の[パラグラフ]と認識される。

```markdown
- リスト項目

  A   |   B
----- | -----
12345 | 67890
```

> - リスト項目
> 
>   A   |   B
> ----- | -----
> 12345 | 67890

さらにヘッダ行の先頭に`|`を用いてやっと意図した通りに認識する([空行]と両方必要)。このように行頭の`|`は構文認識の点でも大きな効果がある。

```markdown
- リスト項目

|   A   |   B
| ----- | -----
| 12345 | 67890
```

> - リスト項目
> 
> |   A   |   B
> | ----- | -----
> | 12345 | 67890

表の直後のブロック構文との判別にも注意。直後が[ブロック引用]、[リスト]または[タスクリスト]であれば[空行]不要。

```markdown
| A | B |
| - | - |
| X | Y |
> 引用

| A | B |
| - | - |
| X | Y |
- リスト

| A | B |
| - | - |
| X | Y |
- [x] タスクリスト
```

> | A | B |
> | - | - |
> | X | y |
> > 引用
> 
> | A | B |
> | - | - |
> | X | y |
> - リスト
> 
> | A | B |
> | - | - |
> | X | Y |
> - [x] タスクリスト

しかし他の[ブロック]ではそうはいかない。間を開けずにすぐ文を書くとセルと認識されてしまう。

```markdown
| A | B |
| - | - |
| X | y |
パラグラフではない
```

> | A | B |
> | - | - |
> | X | y |
> パラグラフではない

この場合は[空行]で区切れば認識する。

```markdown
| A | B |
| - | - |
| X | y |

パラグラフ
```

> | A | B |
> | - | - |
> | X | y |
> 
> パラグラフ

こういうことをいちいち覚えるよりも、より実用的・実践的に「表の前後には[空行]が必要」と覚えておくと分かりやすい。行頭・行末の`|`も同様で、この2点さえ押さえておけば誤認識の多くは未然に防止できる。

------------------------------------------------------------------------

[横線]
← [目次] →
[コードブロック]

[Babelmark]: history.md#babelmark
[GitHub Markdown環境]: github-markdown.md
[HTMLインライン]: html-inlines.md
[インデントによるコードブロック]: code-blocks.md#インデントによるコードブロック
[インライン]: inlines.md
[コードスパン]: code-spans.md
[コードブロック]: code-blocks.md
[タスクリスト]: task-lists.md
[バックスラッシュエスケープ]: backslash-escapes.md
[ハード改行]: paragraphs.md#ハード改行
[パラグラフ]: paragraphs.md
[ブロック引用]: block-quotes.md
[ブロック]: blocks.md
[リスト]: lists.md
[リスト項目]: lists.md#リスト項目
[空行]: characters.md#空行
[目次]: index.md
[横線]: horizontal-rules.md
